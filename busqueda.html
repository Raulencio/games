<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Bosque M√°gico</title>
    <style>
        body,
        html {
            cursor: url('cursor2.png'), auto;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        #fondo {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: url('fondobusqueda.png') repeat-x;
            background-size: auto 100%;
        }

        #menuInicio {
            position: absolute;
            top: 60%;
            left: 40%;
            padding: 20px;
            border-radius: 10px;
            font-family: sans-serif;
            text-align: center;
            cursor: pointer;
        }

        #objetos {
            position: absolute;
            top: 0;
            left: 0;
            width: 400%;
            height: 100%;
            min-height: 100vh;
            pointer-events: none;
            /* permite clickear fondo sin bloquear */
        }

        .objeto {
            position: absolute;
            pointer-events: auto;
            /* habilita interactividad */
            transition: transform 0.2s ease, filter 0.2s ease;
        }

        .objeto:hover {
            filter: drop-shadow(0 0 10px rgba(255, 255, 200, 0.8));
            transform: scale(1.1);
        }

        #sol {
            position: absolute;
            width: 80px;
            height: 80px;
        }

        @media (max-width: 768px) {
            #fondo {
                width: 800%;
            }

            .objeto {
                min-width: 20px;
                /* evita desaparici√≥n en m√≥viles */
            }
        }
    </style>
</head>

<body>

    <div id="fondo"></div>

    <div id="menuInicio">
        <h1>Iniciar</h1>
    </div>

    <div id="objetos"></div>

    <script src="js/jquery-3.5.1.js"></script>
    <script src="js/skrips.js"></script>

    <script>
        const menuInicio = document.getElementById('menuInicio');
        const fondo = document.getElementById('fondo');
        const objetos = document.getElementById('objetos');

        let desplazamiento = 0;
        let animando = false;
        let animationFrame;
        let solPosX = 2400;
        let solPosY = 50;
        let solDirection = 1;

        function moverEstrellas() {
            let nes = 150;
            for (let u = 0; u < nes; u++) {
                let w = randomAr(2, 1);
                let estrellita = document.createElement("div");
                estrellita.style.position = "absolute";
                estrellita.style.left = randomAr(42000, 20) + "px";
                estrellita.style.top = randomAr(24, 1) + "%";
                estrellita.style.width = w + "px";
                estrellita.style.height = w + "px";
                estrellita.style.backgroundColor = colorRan();
                estrellita.style.borderRadius = w + "px";
                estrellita.className = "estrellita";
                estrellita.style.boxShadow = "0 0 " + randomAr(4, 2) + "px " + randomAr(1, 0) + "px " + colorRan();
                document.querySelector("#objetos").appendChild(estrellita); // cambia de #fondo a #objetos
            }
        }


        function moverFondo() {
            if (animando) {
                desplazamiento -= 2;
                fondo.style.backgroundPositionX = desplazamiento + 'px';
                // Mueve tambi√©n #objetos (donde est√°n las estrellas)
                objetos.style.transform = `translateX(${desplazamiento}px)`;
                animationFrame = requestAnimationFrame(moverFondo);
            }
        }


        menuInicio.addEventListener('click', () => {
            menuInicio.style.display = 'none';
            crearObjetosAleatorios();
            crearSol();
            moverEstrellas();
            animando = true;
            moverFondo();
        });

        document.body.addEventListener('click', () => {
            if (menuInicio.style.display === 'none') {
                animando = !animando;
                if (animando) {
                    moverFondo();
                } else {
                    cancelAnimationFrame(animationFrame);
                }
            }
        });

        function crearObjetosAleatorios() {
            const tipos = ['floramarilla', 'hongogris', 'hongorojo', 'arbolito'];
            let fondoHeight = window.innerHeight;
            let minTop = fondoHeight * 0.65; // genera desde 65% hacia abajo
            let maxTop = fondoHeight - 50;

            for (let i = 0; i < 42; i++) {
                let tipo = tipos[Math.floor(Math.random() * tipos.length)];
                let img = document.createElement('img');
                img.src = `${tipo}.png`;
                img.className = 'objeto';
                img.style.left = 28 + (Math.random() * 800) + '%';

                let topPx = minTop + Math.random() * (maxTop - minTop);
                img.style.top = topPx + 'px';

                img.style.zIndex = Math.floor(topPx);

                img.onload = function () {
                    let anchoOriginal = img.naturalWidth;
                    let porcentaje = (topPx - minTop) / (maxTop - minTop);
                    porcentaje = 0.2 + porcentaje * 0.8;
                    let anchoCalculado = anchoOriginal * porcentaje;
                    img.style.width = anchoCalculado + 'px';
                };

                objetos.appendChild(img);
            }
        }

        function crearSol() {
            let sol = document.createElement('img');
            sol.src = 'solcongafas.png';
            sol.id = 'sol';
            sol.style.left = solPosX + 'px';
            sol.style.top = solPosY + 'px';
            objetos.appendChild(sol);

            setInterval(() => {
                solPosX += 1 * solDirection;
                solPosY += 0.2 * solDirection;

                if (solPosX > window.innerWidth - 80 || solPosX < 0) {
                    solDirection *= -1;
                }

                sol.style.left = solPosX + 'px';
                sol.style.top = solPosY + 'px';
            }, 50);
        }

        // üåü Funciones randomAr y colorRan (si no est√°n en skrips.js, agr√©galas)
        function randomAr(max, min) {
            return Math.floor(Math.random() * (max - min + 1) + min);
        }

        function colorRan() {
            const letters = '0123456789ABCDEF';
            let color = '#';
            for (let i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }

    </script>

</body>

</html>